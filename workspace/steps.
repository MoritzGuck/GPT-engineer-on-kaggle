from data_loader import DataLoader
from model_trainer import ModelTrainer
from model_evaluator import ModelEvaluator
from model_predictor import ModelPredictor
from submission_writer import SubmissionWriter

# File paths
train_file = 'data/train.csv'
test_file = 'data/test.csv'
submission_file = 'sample_submission.csv'

# Step 1: Load and preprocess the data
data_loader = DataLoader(train_file, test_file)
data_loader.load_data()
data_loader.preprocess_data()

# Step 2: Train the model
model_trainer = ModelTrainer(data_loader)
model_trainer.train_model()

# Step 3: Evaluate the model
model_evaluator = ModelEvaluator(data_loader, model_trainer)
f1_score = model_evaluator.evaluate_model()
print(f'F1 Score: {f1_score}')

# Step 4: Make predictions
model_predictor = ModelPredictor(data_loader, model_trainer)
predictions = model_predictor.predict()

# Step 5: Write submission file
submission_writer = SubmissionWriter(data_loader, model_predictor, submission_file)
submission_writer.write_submission()
